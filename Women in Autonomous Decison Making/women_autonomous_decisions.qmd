---
title: "Women Making Autonomous Decisons"
author: "Midega George"
format: pdf
editor: visual
---

## Data Cleaning, Manipulation, and Selection

Cape verde, Congos, Egypt, Gambia

```{r}
library(tidyverse, quietly=TRUE)
library(scales)


raw_data <- read.csv("yearly_progression.csv")[, -c(4)]
clean_1 <- raw_data %>%
  pivot_longer(cols=contains("..YR", ignore.case=FALSE), names_to="Year", 
               values_to="values") %>%
  rename(Region=Country.Name, `Region code`=Country.Code, 
         variables=Series.Name)%>%
  pivot_wider(., names_from=variables, values_from=values) %>%
  mutate(Year=str_sub(Year, 2, 5))%>%
  mutate_at(c('Year'), as.numeric)

equality <- clean_1[, 1:17]
health <- clean_1[, c(1:3, 18:22)]
visits <- clean_1[, c(1:3, 23:26, 32)]
purchases <- clean_1[, c(1:3, 27:31)]
participation <- clean_1[, c(34:40)]
```

## Exploring Equality

```{r}
recode.names <- c("Region", "Region code", "Year",  "Passport application", 
                  "Head of household", "Choice of where to live", 
                  "Getting a job", "Obtain a judgment of divorce", 
                  "Open a bank account", "Business registration", 
                  "Signing contracts", "Travelling outside home", 
                  "Travelling outside the country", "Working at night", 
                  "Working in job deemed dangerous", 
                  "Working in an industrial job", "Same right to remarry")

colnames(equality) <- recode.names
equality[is.na(equality)] = 3
equality[, 4:17] <- lapply(equality[, 4:17], factor)

unique(equality$Region)
```

```{r}
continents <- read.csv("africa_clean_coords.csv")
africa_countries <- continents %>%
  filter(Continent == "Africa")

africa_map <- map_data("world", region=africa_countries$Country)




continents %>%
  filter(Continent == "Africa") %>%
  left_join(world, by=c("Country"="region")) %>%
  distinct(Country, .keep_all=TRUE)
  
  
unique_av <- world %>%
  group_by(region) %>%
  distinct(region, .keep_all=TRUE)

africa_countries

#coords <- read.csv("countries_coordinates.csv")
#labels <- left_join(world, coords, by=c("region"="country"))[, -c(1, 2)]
#labels <- left_join(equality, labels, by=c("Region"="region"))

#labels <- labels %>%
 # rename(lat=latitude, long=longitude) %>%
  # group_by(`Region code`, group) %>%
  # distinct(`Region code`, group, .keep_all=TRUE)
```







```{r}
ggplot(east_data, aes(x=long, y=lat, group=group))+
  coord_fixed(1.5)+
  geom_polygon(aes(fill=Q_1), color="#ffefdb")+
  scale_fill_manual(values=c("#0b84a5", "#f17853"), labels=(c("No", "Yes")), 
                    name="Equality in Passport Application")+
  ggrepel::geom_label_repel(aes(label= code), data= labels, 
                            size=2.5, max.overlaps = 50, label.size=0, 
                            arrow=arrow(length=unit(0.1, 'cm'))) +
  labs(caption=paste0("Data Source: World Bank\n", "Author: Midega George Last Update 2023/01/31"))+
  theme(axis.text=element_blank(),
        axis.ticks=element_blank(),
        axis.title=element_blank(),
        rect=element_blank(),
        axis.line = element_blank(),
        panel.border = element_blank(),
        panel.grid = element_blank(),
        panel.background = element_rect(fill = "antiquewhite2"),
        legend.position="bottom", legend.title=element_text(size=10))

```

