---
title: "Women Making Autonomous Decisons"
author: "Midega George"
format: pdf
editor: visual
---

```{r}
library(tidyverse, quietly=TRUE)

females <- read.csv("women_autonomous_decisions.csv", na.strings="..")
females_narrower <- females[, c(1, 3, 7)]
colnames(females_narrower) <- c("name", "region", "response")
females_narrower$region[females_narrower$region == "Congo, Dem. Rep."] <- 
  "Democratic Republic of the Congo"

females_wider <- pivot_wider(females_narrower, names_from=name, 
                             values_from=response)

women_vs_men <- females_wider[, c(1:15)]
colnames(women_vs_men) <- c("region", paste0("Q_", 1:14))
```


```{r}
library(scales)
east_africa <- map_data("world", region=unique(women_vs_men$region))
east_data <- left_join(women_vs_men, east_africa, by=c("region"))

labels <- east_data %>%
  distinct(region, Q_1, .keep_all=TRUE) %>%
  filter(!is.na(Q_1))
  
  
ggplot(east_data, aes(x=long, y=lat, group=group))+
  coord_fixed(1.5)+
  geom_polygon(aes(fill=Q_1), color="red")+
  scale_fill_manual(values=c("blue", "yellow"))+
  ggrepel::geom_label_repel(aes(label= region), data= labels, 
                            size=2.5, max.overlaps = 50, label.size=0, 
                            arrow=arrow(length=unit(0.1, 'cm')))
```
